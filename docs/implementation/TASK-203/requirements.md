# TASK-203: メタデータ表示コンポーネント要件定義

## 概要

PNGファイルから抽出されたメタデータを整理された形で表示するUIコンポーネント群を実装する。各種メタデータを専用のカードコンポーネントで表示し、ユーザーが情報を理解しやすい形で提示する。

## 機能要件

### REQ-META-001: 基本画像情報表示
- ファイル名、ファイルサイズ、画像寸法、色深度、カラータイプを表示する
- 圧縮方式、フィルター方式、インターレース方式の技術情報を表示する
- 画像の基本仕様を一目で理解できる形で整理する

### REQ-META-002: テキストメタデータ表示
- tEXt、iTXt、zTXtチャンクからのテキスト情報を表示する
- キーワードとテキスト内容をペアで表示する
- 国際化対応（言語タグ、翻訳キーワード）の情報を含める
- 圧縮有無の表示を含める

### REQ-META-003: タイムスタンプ表示
- tIMEチャンクからの作成/更新日時を表示する
- 人間が読みやすい日時形式で表示する
- 相対時間（例：2日前）も併記する

### REQ-META-004: 物理的寸法表示
- pHYsチャンクからのピクセル密度情報を表示する
- DPI計算結果を表示する
- 実際の印刷サイズ情報を表示する

### REQ-META-005: その他チャンク表示
- メタデータ以外のPNGチャンク情報を一覧表示する
- チャンクタイプ、サイズ、説明、重要度を表示する
- 技術的な詳細情報として提供する

### REQ-META-006: 表示状態管理
- メタデータが存在しない場合、「メタデータなし」と表示する
- 各カテゴリが空の場合、適切な空状態メッセージを表示する
- ロード中状態の表示を行う

## 非機能要件

### NFR-META-001: 可読性
- 情報を階層的に整理して表示する
- 技術的な値には説明を併記する
- 長いテキストは適切に改行・省略する

### NFR-META-002: レスポンシブデザイン
- モバイルデバイスでスクロール可能な縦レイアウト
- デスクトップではカード配置の最適化
- 画面サイズに応じた情報密度調整

### NFR-META-003: アクセシビリティ
- スクリーンリーダー対応のセマンティックHTML
- キーボードナビゲーション対応
- 高コントラスト表示対応

### NFR-META-004: パフォーマンス
- 大量のメタデータでも快適な表示
- 仮想化による長いリスト最適化
- 必要に応じた遅延読み込み

## コンポーネント構成

### MetadataDisplay (メインコンポーネント)
```typescript
interface MetadataDisplayProps {
  /** 表示するメタデータ */
  metadata: PngMetadata;
  /** ロード中状態 */
  loading?: boolean;
  /** エラー状態 */
  error?: AppError | null;
  /** 追加のCSSクラス */
  className?: string;
}
```

### BasicInfoCard
```typescript
interface BasicInfoCardProps {
  /** 基本画像情報 */
  basicInfo: PngBasicInfo;
  /** カードの折りたたみ状態 */
  collapsed?: boolean;
  /** 折りたたみ変更時のコールバック */
  onToggleCollapse?: (collapsed: boolean) => void;
}
```

### TextMetadataCard
```typescript
interface TextMetadataCardProps {
  /** テキストメタデータ配列 */
  textMetadata: PngTextMetadata[];
  /** カードの折りたたみ状態 */
  collapsed?: boolean;
  /** 折りたたみ変更時のコールバック */
  onToggleCollapse?: (collapsed: boolean) => void;
}
```

### TimestampCard
```typescript
interface TimestampCardProps {
  /** タイムスタンプ情報 */
  timestamp: PngTimestamp;
  /** カードの折りたたみ状態 */
  collapsed?: boolean;
  /** 折りたたみ変更時のコールバック */
  onToggleCollapse?: (collapsed: boolean) => void;
}
```

### PhysicalDimensionsCard
```typescript
interface PhysicalDimensionsCardProps {
  /** 物理的寸法情報 */
  dimensions: PngPhysicalDimensions;
  /** 画像の幅と高さ（DPI計算用） */
  imageWidth: number;
  imageHeight: number;
  /** カードの折りたたみ状態 */
  collapsed?: boolean;
  /** 折りたたみ変更時のコールバック */
  onToggleCollapse?: (collapsed: boolean) => void;
}
```

### OtherChunksCard
```typescript
interface OtherChunksCardProps {
  /** その他のチャンク情報 */
  chunks: PngChunkInfo[];
  /** カードの折りたたみ状態 */
  collapsed?: boolean;
  /** 折りたたみ変更時のコールバック */
  onToggleCollapse?: (collapsed: boolean) => void;
}
```

## UI/UX要件

### 視覚的階層
- **レベル1**: メインカテゴリ（基本情報、テキスト等）
- **レベル2**: サブカテゴリ（各種値）
- **レベル3**: 詳細説明・補足情報

### 情報密度管理
- **重要度High**: 常に表示（ファイル名、サイズ、寸法）
- **重要度Medium**: 折りたたみ可能（テキストメタデータ）
- **重要度Low**: デフォルト折りたたみ（技術的詳細）

### インタラクション
- カード単位での折りたたみ/展開
- 長いテキストの展開/省略切り替え
- テキスト選択・コピー可能

## データ表示仕様

### ファイルサイズ表示
```
例: 1.2 MB (1,234,567 bytes)
```

### 画像寸法表示
```
例: 1920 × 1080 pixels
```

### 色深度・カラータイプ表示
```
例: 8-bit RGB (True Color)
     4-bit Palette (Indexed Color)
     16-bit Grayscale with Alpha
```

### 日時表示
```
例: 2024年1月15日 14:30:45
     (2日前に作成)
```

### DPI表示
```
例: 72 DPI (水平) × 72 DPI (垂直)
     印刷サイズ: 26.7 × 15.0 cm
```

### チャンクサイズ表示
```
例: IDAT: 1.2 MB (Critical)
     tEXt: 156 bytes (Ancillary)
```

## エラーハンドリング

### 空状態メッセージ
- **メタデータなし**: 「このPNGファイルにはメタデータが含まれていません」
- **テキストなし**: 「テキストメタデータはありません」
- **タイムスタンプなし**: 「作成日時情報はありません」

### データ不正時の表示
- **無効な値**: 「不正な値」と表示
- **解析エラー**: 「解析に失敗しました」と表示
- **部分的エラー**: 正常部分のみ表示、エラー部分は除外

## 受け入れ基準

### AC-META-001: 基本情報表示
- [ ] ファイル名、サイズ、画像寸法が表示される
- [ ] 色深度とカラータイプが分かりやすく表示される
- [ ] 技術仕様が適切に説明される

### AC-META-002: テキストメタデータ表示
- [ ] キーワードとテキストのペアが表示される
- [ ] 国際化情報（言語、翻訳）が表示される
- [ ] 圧縮状態が表示される

### AC-META-003: タイムスタンプ表示
- [ ] 作成日時が人間が読める形式で表示される
- [ ] 相対時間が併記される
- [ ] タイムゾーン情報が適切に処理される

### AC-META-004: 物理的寸法表示
- [ ] ピクセル密度がDPIとして表示される
- [ ] 印刷サイズが計算・表示される
- [ ] 単位情報が明確に表示される

### AC-META-005: その他チャンク表示
- [ ] チャンクタイプとサイズが表示される
- [ ] 重要度（Critical/Ancillary）が表示される
- [ ] チャンクの説明が表示される

### AC-META-006: レスポンシブ対応
- [ ] モバイルで縦スクロール可能
- [ ] デスクトップで効率的なレイアウト
- [ ] 画面サイズに応じた情報密度調整

### AC-META-007: アクセシビリティ
- [ ] スクリーンリーダーで情報が読み上げられる
- [ ] キーボードでカードの折りたたみ操作ができる
- [ ] 高コントラストモードで視認可能

## テストケース

### 表示テスト
1. 完全なメタデータセットの表示
2. 部分的なメタデータセットの表示
3. 空のメタデータセットの表示
4. 大量のテキストメタデータの表示
5. 特殊文字・多言語テキストの表示

### インタラクションテスト
1. カードの折りたたみ/展開操作
2. 長いテキストの省略/展開操作
3. キーボードナビゲーション
4. テキスト選択・コピー

### レスポンシブテスト
1. モバイル画面での表示
2. タブレット画面での表示
3. デスクトップ画面での表示
4. 極小画面での表示

### エラーケーステスト
1. 不正なメタデータ値の処理
2. 解析エラー時の表示
3. ネットワークエラー時の表示
4. 部分的データ欠損時の表示